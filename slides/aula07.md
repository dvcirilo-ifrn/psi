---
theme: default
size: 4:3
marp: true
paginate: true
_paginate: false
title: Aula 07: Models
author: Diego Cirilo

---
<style>
img {
  display: block;
  margin: 0 auto;
}
</style>

# <!-- fit --> Programa√ß√£o de Sistemas para Internet

### Prof. Diego Cirilo

**Aula 07**: Models

---
# Dados do sistema
- Como armazenar os dados do sistema?
- Conte√∫do, dados de usu√°rio, etc.
- SGBD - Sistema de Gerenciamento de Banco de Dados
- SQL - *Structured Query Language*

---
# Configura√ß√µes do BD
- No arquivo `settings.py` h√° a se√ß√£o `DATABASES`
- Podemos configurar diversos SGBDs
- Ex. MySQL, PostGres, SQLite, etc.
- Para desenvolvimento o SQLite √© simples e exige menos configura√ß√£o
- No sistema final devemos usar um SGBD mais completo (veremos em ICS)

---
# Configura√ß√µes de BD

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}
```

---
# ORM
- Gerenciar comandos SQL pode ser complicado.
- ORM - *Object Relational Mapping*
- Podemos tratar os dados do BD como objetos

---
# Models Django
- No Django o ORM √© feito nos *Models* (`models.py`)
- Nele definimos os modelos de dados, seus atributos e comportamento.
- Cada modelo √© uma classe Python que herda de `django.db.models.Model`
- Cada atributo de um model representa um campo no BD
- O Django se responsabiliza por gerenciar as tabelas, *queries*, etc.

---
# Exemplo
```py
from django.db import models

class Pessoa(models.Model):
    nome = models.CharField(max_length=30)
    sobrenome = models.CharField(max_length=30)
```
```sql
CREATE TABLE myapp_pessoa (
    "id" bigint NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "nome" varchar(30) NOT NULL,
    "sobrenome" varchar(30) NOT NULL
);
```

---
# Alguns tipos de dados

- CharField: Textos curtos (nomes, t√≠tulos).
- TextField: Textos longos (descri√ß√µes, artigos).
- IntegerField: N√∫meros inteiros (idades, quantidades).
- FloatField: N√∫meros decimais (pre√ßos, m√©dias).
- BooleanField: Valores booleanos (Verdadeiro/Falso).
- DateField: Datas (anivers√°rios, datas de cria√ß√£o).
- DateTimeField: Datas e horas (eventos, logs).
- EmailField: Endere√ßos de e-mail (valida√ß√£o autom√°tica).
- ForeignKey: Relacionamentos um-para-muitos.
- ManyToManyField: Relacionamentos muitos-para-muitos.

---
# Migrations
- Arquivo com comandos para o SGBD
- Permite recriar a estrutura (*schema*) do BD em qualquer computador.
- Novas migra√ß√µes devem ser criadas sempre que alteramos os dados em Models
- `python manage.py makemigrations`
- Para **aplicar** as *migrations*, ou seja, criar/alterar as tabelas no SGBD:
- `python manage.py migrate`
- √â importante sempre lembrar de criar/aplicar as migrations.

---
# Django Admin
- O Django foi pensado para facilitar o processo de desenvolvimento
- Um projeto Django j√° possui uma interface de administra√ß√£o pronta
- Para ativar, temos que:
    - Adicionar os models ao arquivo `admin.py`
    - Criar um *superuser* do sistema
    - Executar as *migrations*

---
# Django Admin
```
from django.contrib import admin

from .models import Tarefa

admin.site.register(Tarefa)
```

---
# Django Admin
- Para criar o *superuser*
- `python manage.py createsuperuser`
- Para criar as *migrations*
- `python manage.py makemigrations`
- Para executar as *migrations*
- `python manage.py migrate`

---

# <!--fit--> D√∫vidas? ü§î
